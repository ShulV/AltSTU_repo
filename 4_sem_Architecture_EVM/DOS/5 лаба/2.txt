		; программа вычисляет RESULT:= F(X,Y) + F(Y,X) - F(2,3)
.db 0a			;
.db 1a			;
.org 08			;
.db 0d0
.db 0e0	

.org 0a			;
di			;
			; ЗАПИСЬ X,Y
in 0			; ввод X (содерж. порта 0 заносится в rA)
mvi b,X			; непосредственная загрузка
stor a,0(b)		; сохр. x
in 1			; ввод Y (содерж. порта 1 заносится в rA)
stor a,1(b)		; сохр. y
ei			;
rin			;

.org 1a
di
out 3
ei
rin

		; ПОДГОТОВИТЬ ТАБЛИЦУ АДРЕСОВ ПАРАМЕТРОВ
mvi a,AA		; непосредственная загрузка операнда AA в rA
stor a,TABPAR1		; операнд из rA копируется по абс. адресу TABPAR1
mvi a,BB		; непосредственная загрузка операнда BB в rA
stor a,TABPAR2 		; операнд из rA копируется по абс. адресу TABPAR2
mvi a,F			; непосредственная загрузка операнда F в rA
stor a,TABPAR3 		; операнд из rA копируется по абс. адресу TABPAR3

int 0			;
		; ПОСЧЁТ F(X,Y) + F(Y,X) - F(2,3)
	;F(X,Y)
load a,X		; загрузить X в rA
load b,Y		; загрузить Y в rB
stor a,AA		; запись rA (X) в AA (содерж. rA копир. по абс. адр. AA)
stor b,BB		; запись rB (Y) в BB (содерж. rB копир. по абс. адр. BB)
mvi a,TABPAR1		; загрузка в TABPAR1 (адреса таблицы) в rA
call FUNC		; вызов функции и подсчёт F(X,Y)
load a,F		; загрузить результат функции в rA
stor a,RESULT		; запись рзультата функции по абс. адр. RESULT
	;F(Y,X)
load a,X		; загрузить X в rA
load b,Y		; загрузить Y в rB
stor b,AA		; запись rB (Y) в AA (содерж. rB копир. по абс. адр. AA)
stor a,BB		; запись rA (X) в BB (содерж. rA копир. по абс. адр. BB)
mvi a,TABPAR1		; загрузка в TABPAR1 (адреса таблицы) в rA
call FUNC		; вызов функции и подсчёт F(Y,X)
load a,F		; загрузить результат функции в rA
load b,RESULT		; загрузить текущий результат
adr a,b			; сложить F(X,Y) и F(Y,X). Рез. в rA
stor a,RESULT		; запись рзультата функции по абс. адр. RESULT
	;F(2,3)
mvi a,2			; непосред. загрузка 2 в rA
mvi b,3			; непосред. загрузка 3 в rB
stor a,AA		; запись rA (2) в AA (содерж. rA копир. по абс. адр. AA)
stor b,BB		; запись rB (3) в BB (содерж. rB копир. по абс. адр. BB)
mvi a,TABPAR1		; загрузка в TABPAR1 (адреса таблицы) в rA
call FUNC		; вызов функции и подсчёт F(X,Y)
load a,RESULT		; загрузить текущий результат
load b,F		; загрузить результат функции в rB
sbr a,b			; вычесть F(2,3) из [F(X,Y)+F(Y,X)]. Рез. в rA
stor a,RESULT		; запись рзультата функции по абс. адр. RESULT
int 1			; 

Stop			; останов


		;
X: .ds 1		; резервир. 1 байта под X
Y: .ds 1		; резервир. 1 байта под Y
RESULT: .ds 1		; резервир. 1 байта под результат
AA: .ds 1		; резервир. 1 байта под параметр функ. F(A,B)
BB: .ds 1		; резервир. 1 байта под параметр функ. F(A,B)
F: .ds 1		; резервир. 1 байта под значение F(A,B)
TABPAR1: .ds 1		; резервир. 1 байта под ссылку на AA
TABPAR2: .ds 1		; резервир. 1 байта под ссылку на BB
TABPAR3: .ds 1		; резервир. 1 байта под ссылку на F
		; подпрограмма вычисления F(A,B)= (B*B-1) + (A+B)*(A+B)
		; вход: (rA) - таблица адресов
		; выход: новое значение TABPAR3 (F) в таблице адресов
FUNC: push a		; сохранить в стеке адрес таблицы
load b,0(a)		; загрузка в rB значения TABPAR1 (АДРЕСА AA)
load b,0(b)		; загрузка в rB ЗНАЧЕНИЯ AA
load a,1(a)		; загрузка в rA значения TABPAR2 (АДРЕСА BB)
load a,0(a)		; загрузка в rA ЗНАЧЕНИЯ BB
adr a,b			; сложение регистров (рез. в rA)
mov b,a			; копирование rA в rB
mur a,a			; умножение R1+1 на R2, т.е. rB*rA [(A+B)^2]. Рез. в паре.
pop a			; вытянуть адрес таблицы в rA
push a			; запушить адрес таблицы
push b			; положить (A+B)^2 в стек
load b,1(a)		; загрузка в rB значения TABPAR2 (АДРЕСА BB)
load b,0(b)		; загрузка в rB ЗНАЧЕНИЯ BB
mur a,b			; умножение R1+1 на R2, т.е. rB*rB [B*B]. Рез. в паре.
sbi b,1			; непосредственное вычитание [B*B]-1. Рез. в rB.
pop a			; вытянуть
adr a,b			; сложение регистров [(A+B)^2 + (B*B)-1](рез. в rA)
pop b			; вытянуть адрес таблицы в rB
load b,2(b)		; загрузка адреса TABPAR3 в rB
stor a,0(b)		; загрузка значения функции по адресу, лежащему в rB 
ret			;

		; Программное прерывание (ввод)
